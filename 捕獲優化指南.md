# 投影片捕獲優化指南

## 🎯 問題：捕獲太多相似的投影片

### 原因分析
1. **取樣過於頻繁**：預設每 0.5 秒取樣一次
2. **相似度閾值太低**：0.7 的閾值對細微變化太敏感
3. **缺乏全局比較**：只與前一張比較，沒有檢查是否與之前所有投影片重複

## 🔧 已實施的改進

### 1. 智能重複檢測
- **全局比較**：新增與所有已保存投影片的比較
- **高相似度過濾**：相似度 > 95% 視為重複，直接跳過
- **最小時間間隔**：強制至少間隔 2 秒才能保存下一張

### 2. 內容增量檢測（新功能）
- **自動檢測分段顯示**：當投影片分段顯示時（如先顯示上半部，再顯示下半部）
- **智能替換機制**：自動替換不完整的版本為完整版本
- **內容比較算法**：計算畫面內容量，當新畫面內容增加 20% 以上時觸發替換

### 3. 更新的預設參數

| 參數 | 舊預設值 | 新預設值 | 說明 |
|------|---------|----------|------|
| 相似度閾值 | 0.7 | **0.85** | 更高的閾值，減少相似投影片 |
| 穩定性閾值 | 0.95 | **0.96** | 確保畫面真正穩定才捕獲 |
| 取樣間隔 | 0.5秒 | **1.0秒** | 減少取樣頻率 |

### 4. 優化的預設設定

#### 標準設定（推薦）
- 相似度：0.85
- 穩定性：0.96
- 間隔：1.0秒
- **適用**：大多數演講影片

#### 捕獲較少的設定
- 相似度：**0.92**（非常高）
- 穩定性：0.98
- 間隔：**2.0秒**
- **適用**：只想捕獲明顯不同的投影片

## 📊 使用建議

### 根據影片類型選擇設定

1. **一般演講/教學影片**
   - 使用「標準設定」
   - 預期結果：每個主要投影片捕獲一次

2. **投影片變化緩慢的影片**
   - 使用「捕獲較少的設定」
   - 預期結果：只捕獲完全不同的投影片

3. **有動畫效果的簡報**
   - 使用「動畫較多的簡報」設定
   - 相似度：0.75（較低）
   - 間隔：0.5秒（較短）

4. **分段顯示的簡報**（新增）
   - 使用「標準設定」即可
   - 程式會自動檢測並替換不完整版本
   - 最終保留最完整的投影片版本

### 手動調整技巧

1. **如果仍然捕獲太多**
   - 提高相似度閾值到 0.90-0.95
   - 增加取樣間隔到 2-3 秒
   - 使用「選擇幻燈片區域」功能，只捕獲投影片區域

2. **如果錯過重要投影片**
   - 降低相似度閾值到 0.80
   - 減少取樣間隔到 0.5 秒

## 🚀 快速開始

1. **執行程式**
   ```bash
   ./start.sh
   ```

2. **選擇預設設定**
   - 在「幻燈片捕獲」標籤頁
   - 從下拉選單選擇適合的預設設定

3. **開始捕獲**
   - 點擊「捕獲幻燈片」按鈕
   - 程式會自動過濾重複投影片

## 💡 進階技巧

### 使用區域選擇
1. 點擊「選擇幻燈片區域」
2. 輸入時間點（秒）
3. 框選投影片區域
4. 這樣可以排除演講者畫面，提高準確度

### 監控捕獲過程
- 觀察控制台輸出
- 如果看到「檢測到內容增加」訊息，表示正在處理分段顯示
- 如果看到「將替換投影片」訊息，表示正在更新為更完整的版本

## 📈 效果對比

### 改進前
- 10 分鐘影片可能捕獲 100+ 張
- 大量重複或相似投影片
- 分段顯示的投影片會有多個不完整版本

### 改進後
- 10 分鐘影片通常捕獲 20-40 張
- 每個投影片只保留一個清晰版本
- **自動保留最完整的投影片版本**

## 🔍 新功能詳解：內容增量檢測

### 工作原理
1. **內容量計算**：計算每張投影片的實際內容像素數
2. **比較機制**：當新畫面內容比舊畫面多 20% 以上時
3. **智能替換**：自動用完整版本替換不完整版本

### 適用場景
- 投影片逐行顯示文字
- 先顯示標題，再顯示內容
- 動畫效果逐步展現內容
- 分段揭示答案或結論

---

如有問題，請參考主要 README 或調整參數設定。 